--- a/modules/e2sr/s1_v6.py
+++ b/modules/e2sr/s1_v6.py
@@ -278,9 +278,15 @@ class GAPDecoder(nn.Module):
             )
             mid = self.FRUList[i_level](_input)

-        x_up = F.interpolate(lr, out_size, mode="bicubic", align_corners=False)
-        out = self.upsampler(mid, out_size) + x_up
+        # ★ 根据是否使用高斯查询调用不同接口 ★
+        if self.use_gaussian_query:
+            # GaussianQueryDecoder 需要 (feat, lr, out_size)
+            out = self.upsampler(mid, lr, out_size)
+        else:
+            # SADNUpsampler 需要 (feat, out_size)
+            x_up = F.interpolate(lr, out_size, mode="bicubic", align_corners=False)
+            out = self.upsampler(mid, out_size) + x_up

         return out

# ============================================================
# 快速修复说明
# ============================================================
#
# 问题: GaussianQueryDecoder.forward() missing 1 required positional argument: 'out_size'
# 原因: GaussianQueryDecoder 需要 3 个参数 (feat, lr, out_size)，而 SADNUpsampler 只需要 2 个
# 解决: 根据 use_gaussian_query 标志调用不同的接口
#
# 应用方法:
#   方法 1: 直接编辑文件
#     nano modules/e2sr/s1_v6.py
#     找到第 280-281 行，替换为补丁内容
#
#   方法 2: 使用 Git（如果已推送修复）
#     git pull origin main
#
#   方法 3: 手动替换（推荐）
#     找到 GAPDecoder.forward() 方法的最后部分
#     将:
#       x_up = F.interpolate(lr, out_size, mode="bicubic", align_corners=False)
#       out = self.upsampler(mid, out_size) + x_up
#     替换为:
#       if self.use_gaussian_query:
#           out = self.upsampler(mid, lr, out_size)
#       else:
#           x_up = F.interpolate(lr, out_size, mode="bicubic", align_corners=False)
#           out = self.upsampler(mid, out_size) + x_up
#
# ============================================================
